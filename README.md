# Flash Sales Market
## 프로젝트 소개
Flash Sales Market은 일반 상품 판매와 **지정된 시간에 오픈되는 선착순 이벤트 상품 판매 기능**을 제공하는 이커머스 플랫폼으로, 선착순 이벤트 상품 판매 시 발생하는 **높은 트래픽을 효율적으로 처리하고 성능을 개선**하는 방법을 학습한 개인 프로젝트입니다.
## 프로젝트 기간
2024.10.18 ~

## 기술 스택
- Languages: Java 21
- Frameworks & Libraries: Spring Boot 3, Spring Cloud, Spring Data Jpa, QueryDSL
- Database: MySQL, Redis
- Infrastructure: Docker
## 시스템 아키텍처
## ERD
## API 명세
## 핵심 기능
### 1. 아키텍처 선택 배경
- 주문 및 결제 등 트래픽이 집중되는 서비스를 독립적으로 확장할 수 있도록 MSA 구조로 설계하였으며, 여러 서비스를 하나의 프로젝트로 관리하기 위해 멀티모듈로 구성된 모노레포 구조를 채택했습니다.
### 2. 서비스 디스커버리 패턴 적용 및 API Gate Way 구축
- 서비스 디스커버리를 통해 각 서비스의 동적 위치 정보를 자동으로 관리하여 서비스 추가 및 변경에 유연하게 대응하였고, API Gateway를 통해 클라이언트 요청을 단일 진입점에서 통합 관리하며 로드 밸런싱을 수행했습니다.
### 3. 선착순 구매 상황을 고려한 재고 선점 방식 도입
- 결제 플로우에서의 빈번한 재고 확인 요청으로 발생하는 상품 서비스 부하와 성능 저하를 방지하고, 결제 중 재고 부족으로 인한 사용자 불만을 줄이기 위해 주문 생성 시 재고 선점 방식을 도입했습니다.
### 4. 이벤트 기반 통신을 통한 상태 변경
- 결제 실패 시 주문 상태를 '실패'로 변경하고 선점된 재고를 해제하며, 결제 성공 시 주문 상태를 '완료'로 변경하고 선점된 재고를 확정 차감하는 로직을 이벤트 기반 통신을 통해 처리합니다.
- 각 상태 변경은 이벤트를 통해 다른 서비스와 통신하며, 주문 상태 및 재고 상태의 일관성을 유지합니다.
### 5. 분산 락을 적용한 동시성 제어
- 재고 선점과 재고 확정 차감 과정에서 발생할 수 있는 동시성 문제를 해결하기 위해 분산락을 적용하여, 여러 주문이 동시에 처리될 때 재고의 중복 차감이나 선점 문제를 방지했습니다.
- 데드락을 방지하기 위해 락을 획득하는 리소스의 순서를 정렬하여 교착 상태를 방지했습니다.
- 비즈니스 로직과 분리하기 위해 AOP를 적용하고, 커스텀 어노테이션을 통해 락을 획득하도록 구현했으며, 트랜잭션 종료 전 락 해제를 방지하기 위해 트랜잭션 어노테이션보다 먼저 적용되도록 설정했습니다."
## 부하 테스트 및 성능 개선
